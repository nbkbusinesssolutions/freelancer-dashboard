ğŸ”’ STEP 1 â€” FREEZE FEATURES (VERY IMPORTANT)

DO THIS FIRST.

âŒ Do NOT add:

New tables

New fields

New UI features

New dashboards

âœ… Only allow:

Bug fixes

Validation

Testing

Hardening

Why:

Every production failure comes from â€œone small extra thingâ€ added too early.

ğŸ§ª STEP 2 â€” VERIFY DATABASE IN SUPABASE (30 minutes)

Go to Supabase Dashboard â†’ Table Editor

For EACH table, confirm:

Checklist

 Primary key exists (id uuid)

 Foreign keys are correct

 created_at default = now()

 RLS enabled

 No public policies

 Indexes exist for FK columns

Then run manual sanity inserts:

INSERT INTO clients (name) VALUES ('Test Client');

SELECT * FROM clients;


If this works â†’ DB is healthy.

ğŸ” STEP 3 â€” VERIFY SECURITY (NON-NEGOTIABLE)
In Supabase â†’ API Settings

Confirm:

âŒ anon key NOT used anywhere

âŒ public access disabled

âœ… service role key only

In Netlify â†’ Environment Variables

Confirm:

SUPABASE_URL
SUPABASE_SERVICE_ROLE_KEY


ğŸš« These must never appear in frontend code or Vite env.

âš™ï¸ STEP 4 â€” TEST NETLIFY FUNCTIONS LOCALLY

Run locally (Netlify CLI or Vite proxy):

Test endpoints one by one
GET /.netlify/functions/clients
POST /.netlify/functions/clients


Test:

Empty DB

Invalid payload

Missing required fields

Delete with invalid ID

Expected:

Clean JSON errors

No stack traces

No crashes

If one function fails â†’ fix it now, not later.

ğŸ” STEP 5 â€” FRONTEND END-TO-END TEST (API MODE)
Force API mode

Temporarily disable localStorage fallback.

Test flows:

âœ” Create client
âœ” Create project linked to client
âœ” Add email account
âœ” Link email to project
âœ” Create invoice â†’ items
âœ” Create AI subscription
âœ” Delete something (confirm cascade rules)

If any UI breaks, fix mapping â€” not schema.

ğŸ§¬ STEP 6 â€” RUN MIGRATION (OPTIONAL BUT IMPORTANT)

Only do this after everything above passes.

Safe migration flow

Open existing app (with data)

Run:

exportData()


Save JSON

Run:

node scripts/migrate-to-supabase.js data.json

After migration

Compare counts:

clients

projects

invoices

Spot check:

One client

One project

One invoice with items

ğŸš¨ Do NOT delete localStorage yet.

ğŸš€ STEP 7 â€” DEPLOY TO NETLIFY (PRODUCTION)

Now do the actual deployment.

Netlify settings

Build command: npm run build

Publish directory: dist

Functions directory: netlify/functions

After deploy

Test:

Fresh browser

Incognito

Mobile

If data loads â†’ backend is live.

ğŸ§¹ STEP 8 â€” POST-DEPLOY CLEANUP (IMPORTANT)

Only after 1â€“2 days of stable use:

 Remove console logs

 Disable migration script

 Keep localStorage fallback (read-only)

 Add JSON export backup button (manual safety)

ğŸ›¡ï¸ STEP 9 â€” BACKUP & DISASTER SAFETY

Set a monthly habit (manual is enough):

Supabase â†’ Download SQL backup

Frontend â†’ Export JSON

Thatâ€™s it. No automation needed.